# KurashiNavi Security Configuration

# Enable rewrite engine
RewriteEngine On

# Security Headers
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options DENY
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
    Header always set Permissions-Policy "geolocation=(), microphone=(), camera=()"
</IfModule>

# Block access to sensitive files
<FilesMatch "\.(htaccess|htpasswd|ini|log|sh|inc|bak|sql)$">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# Block access to model files
<FilesMatch "^(db|database|User|Community|Guide|Service|Contact)\.php$">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# Block access to includes directory
<FilesMatch "^(auth_check|check_user|check_db|debug|process_.*|setup_.*)\.php$">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# Allow access to main pages
<Files "index.php">
    Order Allow,Deny
    Allow from all
</Files>

<Files "login.php">
    Order Allow,Deny
    Allow from all
</Files>

<Files "register.php">
    Order Allow,Deny
    Allow from all
</Files>

<Files "services.php">
    Order Allow,Deny
    Allow from all
</Files>

<Files "guide.php">
    Order Allow,Deny
    Allow from all
</Files>

<Files "community.php">
    Order Allow,Deny
    Allow from all
</Files>

<Files "contact.php">
    Order Allow,Deny
    Allow from all
</Files>

# Block directory browsing
Options -Indexes

# Prevent access to .git directory
RedirectMatch 404 /\.git

# Custom error pages
ErrorDocument 403 /login.php
ErrorDocument 404 /index.php 